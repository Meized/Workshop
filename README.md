# Мастерская 2 — Маркетинг интернет-магазина
Интернет-магазин собирает историю покупателей, проводит рассылки предложений и 
планирует будущие продажи. Для оптимизации процессов надо выделить пользователей 
которые готовы совершить покупку в ближайшее врем

Нам предоставлены данные по истории покупателей. У нас есть история того как тот или иной покупатель реагировал на коммуникацию, которая проводилась. Под коммуникацией мы имеем ввиду, например, промо-предложение, направленное в смс / push сообщении. По каждому товару проставлена категория, которая помогает определить насколько покупатель “латентен” (предпочтителен) к этой группе товаров.
**Цель** -  создать модель прогнозирования покупки каждым покупателем в ближайшие 90 дней. Это нужно для улучшения работы и повышения эффективности марктетинговых компаний.
### Описание данных
* ```apparel-purchases```

Данные о покупках клиентов по дням и по товарам. В каждой записи покупка
определенного товара, его цена, количество штук.

В таблице есть списки идентификаторов, к каким категориям относится товар. Часто
это вложенные категории (например автотовары-аксессуары-освежители), но также может
включать в начале списка маркер распродажи или маркер женщинам/мужчинам. Нумерация категорий сквозная для всех уровней, то есть 44 на второй позиции списка или на третьей – это одна и та же категория. Иногда дерево категорий обновляется, поэтому могут меняться вложенности, например ['4', '28', '44', '1594'] или ['4', '44', '1594']. **Необходимо обработать такие случаи**.

```client_id``` - идентификатор клиента 

```quantity``` - количество единиц товара

```price``` - цена товара

```category_ids``` - идентификаторы категорий

```date``` - дата покупки

```message_id``` - идентификатор сообщения из рассылки
* ```apparel-messages```

Рассылки, которые были отправлены клиентам из таблицы покупок.

```bulk_campaign_id``` -  идентификатор рассылки

```client_id``` - идентификатор клиента

```message_id```  - идентификатор сообщения

```event``` - действие с сообщением (отправлено, открыто, покупка…)

```channel``` - канал рассылки

```date``` - дата действия

```created_at``` - дата-время полностью
* target

```client_id``` - идентификатор клиента

```target``` - клиент совершил покупку в целевом периоде
* full_campaign_daily_event

Агрегация общей базы рассылок по дням и типам событий

```date``` - дата

```bulk_campaign_id``` - идентификатор рассылки

```count_event*``` - общее количество каждого события event

```nunique_event*``` - количество уникальных client_id в каждом событии

*в именах колонок найдете все типы событий event
* full_campaign_daily_event_channel

Агрегация по дням с учетом событий и каналов рассылки

```date``` - дата

```bulk_campaign_id``` - идентификатор рассылки

```count_event*_channel``` - общее количество каждого события по каналам

```nunique_event*_channel``` - количество уникальных client_id по событиям и каналам

*в именах колонок есть все типы событий event и каналов рассылки channel

**В работе по прогнозированию совершения покупки в ближайшие 90 дней были предобработаны датасеты, проведен исследовательский анализ данных и обучены несколько моделей. В датасете с покупками удаленеие дубликатов не проводилось так как пользователи могут совершать несколько покупок.\
Также были сгенерированы новые призкнаки. В итоговом обучении моделей приняли участие следующие признаки:**
- `category_ids` - категория;
- `quantity` - количество заказов;
- `price` - общая сумма заказов;
- `day_of_week` - день недели;
- `year` - год заказа;
- `avg_price` - средняя цена одного заказа;
- `time_between_message_purchase` - количество дней с момента отправки сообщения до покупки;
- `time_between_message_event` - количество дней с момента отправки сообщения до совершения действия.

**Лучшей моделью оказалась `KNeighborsClassifier` с 4 соседями `roc-auc` метрика на тестовой выборке равна 0.95**
